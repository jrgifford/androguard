# Foncy #

Android/Foncy is a sms android malware which targets european countries.

We can analyze it (sample sha256: 98a402d885cdb941dca8b45a4bbcbbe7f44ba62910d519bc1c2161dba117ebd2) with Androguard, and the Ded decompiler:

![http://androguard.googlecode.com/files/foncy.png](http://androguard.googlecode.com/files/foncy.png)

And we can obtain easily where permissions are used:
![http://androguard.googlecode.com/files/foncy_permissions.png](http://androguard.googlecode.com/files/foncy_permissions.png)

The sendTextMessage method is called 5 times in the bytecodes. If you would like to have a better view of the sample, you can use androgexf.py to generate a gexf file in order to open it with gephi. In this case, the sample is small and there are few methods calls, and it's more interesting with huge application.

![http://androguard.googlecode.com/files/foncy_gephi1.png](http://androguard.googlecode.com/files/foncy_gephi1.png)
![http://androguard.googlecode.com/files/foncy_gephi.png](http://androguard.googlecode.com/files/foncy_gephi.png)

This malware has a specific name "SuiConFo", which is the name of a real application on the android market. And we can check with androsim.py if the writer of the malware has used or not the original code. And in this case, it's a new application:

![http://androguard.googlecode.com/files/simfoncy.png](http://androguard.googlecode.com/files/simfoncy.png)

The first interesting method is onCreate() in MagicSMSActivity, and this method does nothing except to get your country code in order to send a premium rate SMS to a specific number ([r6](https://code.google.com/p/androguard/source/detail?r=6)), with a specific message ([r7](https://code.google.com/p/androguard/source/detail?r=7)):

![http://androguard.googlecode.com/files/foncy_1.png](http://androguard.googlecode.com/files/foncy_1.png)

![http://androguard.googlecode.com/files/foncy_2.png](http://androguard.googlecode.com/files/foncy_2.png)

and finaly send 4 SMS messages:

![http://androguard.googlecode.com/files/foncy_3.png](http://androguard.googlecode.com/files/foncy_3.png)

It's possible to find these premium rate sms on french website:

![http://androguard.googlecode.com/files/hackfoncy.png](http://androguard.googlecode.com/files/hackfoncy.png)

![http://androguard.googlecode.com/files/hackfoncy1.png](http://androguard.googlecode.com/files/hackfoncy1.png)

The other method is onReceive in SMSReceiver, which hides specific number (premium rate number), and send a specific sms message (with the body of the received message) to a french number:

![http://androguard.googlecode.com/files/foncy_4.png](http://androguard.googlecode.com/files/foncy_4.png)

![http://androguard.googlecode.com/files/foncy_5.png](http://androguard.googlecode.com/files/foncy_5.png)

We can found that some end users complain about this specific french number:

![http://androguard.googlecode.com/files/hackfoncy2.png](http://androguard.googlecode.com/files/hackfoncy2.png)

![http://androguard.googlecode.com/files/hackfoncy3.png](http://androguard.googlecode.com/files/hackfoncy3.png)


Foncy android malware is in our opensource [database](http://code.google.com/p/androguard/wiki/DatabaseAndroidMalwares) if you would like to test your apps:

```
desnos@destiny:~/androguard$ ./androsign.py -d apks/malwares/foncy/ -b signatures/dbandroguard -c signatures/dbconfig
98a402d885cdb941dca8b45a4bbcbbe7f44ba62910d519bc1c2161dba117ebd2 : ----> Foncy
81dd17ea168cf884bfb5aebb7cd2241a5624d1ae14444594bf7677e1080339f9 : ----> Foncy
d9ef940236f285548a60be0d575d7bba4587bdfc3f6c56f38b5da601686344a9 : ----> Foncy
SuiConFo 1.26.apk : ----> None
127sc.apk : ----> None
```


# Related links #
  * [Kaspersky](http://www.securelist.com/en/blog/208193261/SMS_Trojans_all_around_the_world)
  * [Fortinet](http://blog.fortiguard.com/androidfoncy-emanating-and-propagating-in-france/)
  * [Sophos](http://nakedsecurity.sophos.com/2012/02/28/android-malware-paris)